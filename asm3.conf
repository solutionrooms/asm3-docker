# ASM3 Docker Configuration File
# This configuration uses environment variables for flexible deployment

# Base application URLs (from environment variables)
base_url = ${ASM3_BASE_URL}
service_url = ${ASM3_SERVICE_URL}

# Locale and timezone settings
locale = en
timezone = 0

# Logging configuration
log_location = stderr
log_debug = true

# Database configuration for PostgreSQL
db_type = POSTGRESQL
db_host = postgres
db_port = 5432
db_username = asm3
db_password = asm3
db_name = asm

# Database settings
db_has_asm2_pk_table = false
db_decode_html_entities = false
db_timeout = 0

# Deployment settings
deployment_type = wsgi
session_secure_cookie = false
session_debug = false

# Caching configuration  
memcached_server = memcached:11211
disk_cache = /tmp/asm_disk_cache
cache_common_queries = true
cache_service_responses = true

# File storage
dbfs_store = database

# Error handling
email_errors = false
admin_email = ${ASM3_ADMIN_EMAIL}

# JavaScript optimization
minify_js = true
rollup_js = false  # Development mode: load individual JS files for instant changes

# File handling
image_hotlinking_only_from_domain =
large_files_chunked = true

# PDF and HTML processing
scale_pdf_during_attach = false
scale_pdf_cmd = convert -density 120 -quality 60 %(input)s -compress Jpeg %(output)s
html_to_pdf = wkhtmltopdf --orientation %(orientation)s %(papersize)s %(input)s %(output)s

# QR code configuration
qr_img_src = //chart.googleapis.com/chart?cht=qr&chl=%(url)s&chs=%(size)s

# Map configuration
map_link = https://www.openstreetmap.org/search?query={0}
map_provider = osm
map_provider_key =
osm_map_tiles = https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png

# Geocoding configuration
geo_provider = nominatim
geo_provider_key =
geo_batch = false
geo_limit = 100
geo_lookup_timeout = 5
geo_sleep_after = 1

# Email configuration (uses environment variables)
# Note: ASM3 will read SMTP settings from environment variables:
# ASM3_SMTP_HOST, ASM3_SMTP_PORT, ASM3_SMTP_USERNAME, ASM3_SMTP_PASSWORD, ASM3_SMTP_TLS
# This configuration is now managed through .env file and docker-compose.yml
smtp_server = { "sendmail": false, "host": "${ASM3_SMTP_HOST}", "port": ${ASM3_SMTP_PORT}, "username": "${ASM3_SMTP_USERNAME}", "password": "${ASM3_SMTP_PASSWORD}", "usetls": ${ASM3_SMTP_TLS} }
from_address = ${ASM3_FROM_ADDRESS}
admin_email = ${ASM3_ADMIN_EMAIL}